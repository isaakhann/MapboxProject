{"ast":null,"code":"var _jsxFileName = \"/Users/isakhan/Documents/MapboxProject/frontend/src/auth/AuthContext.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { createContext, useContext, useEffect, useState } from 'react';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst USERS_KEY = 'app_users_v1';\nconst CURRENT_KEY = 'app_current_user_v1';\n\n// Seed a default admin on first load\nconst defaultUsers = {\n  admin: {\n    password: 'admin',\n    role: 'admin'\n  }\n};\nfunction readUsers() {\n  try {\n    const raw = localStorage.getItem(USERS_KEY);\n    return raw ? JSON.parse(raw) : defaultUsers;\n  } catch {\n    return defaultUsers;\n  }\n}\nfunction writeUsers(users) {\n  localStorage.setItem(USERS_KEY, JSON.stringify(users));\n}\nconst AuthContext = /*#__PURE__*/createContext(null);\nexport function AuthProvider({\n  children\n}) {\n  _s();\n  const [users, setUsers] = useState(() => readUsers());\n  const [currentUser, setCurrentUser] = useState(() => {\n    try {\n      const raw = localStorage.getItem(CURRENT_KEY);\n      return raw ? JSON.parse(raw) : null;\n    } catch {\n      return null;\n    }\n  });\n  useEffect(() => writeUsers(users), [users]);\n  useEffect(() => {\n    if (currentUser) localStorage.setItem(CURRENT_KEY, JSON.stringify(currentUser));else localStorage.removeItem(CURRENT_KEY);\n  }, [currentUser]);\n  const login = (username, password) => {\n    const u = users[username];\n    if (!u || u.password !== password) throw new Error('Invalid credentials');\n    setCurrentUser({\n      username,\n      role: u.role\n    });\n  };\n  const logout = () => setCurrentUser(null);\n  const addUser = (username, password, role = 'user') => {\n    if (!currentUser || currentUser.role !== 'admin') throw new Error('Only admin can add users');\n    if (!username || !password) throw new Error('Username and password required');\n    if (users[username]) throw new Error('User already exists');\n    const next = {\n      ...users,\n      [username]: {\n        password,\n        role\n      }\n    };\n    setUsers(next);\n  };\n\n  // Users can change their own password; admin can change theirs too.\n  const changePassword = (username, oldPass, newPass) => {\n    const target = users[username];\n    if (!target) throw new Error('User not found');\n    if (currentUser.username !== username && currentUser.role !== 'admin') throw new Error('Not allowed');\n\n    // If changing your own password, verify old password\n    if (currentUser.username === username && target.password !== oldPass) throw new Error('Old password incorrect');\n    const next = {\n      ...users,\n      [username]: {\n        ...target,\n        password: newPass\n      }\n    };\n    setUsers(next);\n    if (currentUser.username === username) setCurrentUser({\n      username,\n      role: target.role\n    }); // keep session\n  };\n  const value = {\n    users,\n    currentUser,\n    login,\n    logout,\n    addUser,\n    changePassword\n  };\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: value,\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 80,\n    columnNumber: 10\n  }, this);\n}\n_s(AuthProvider, \"7HWGBvbP9nqGyvQYxL0YR+/XWCE=\");\n_c = AuthProvider;\nexport const useAuth = () => {\n  _s2();\n  return useContext(AuthContext);\n};\n_s2(useAuth, \"gDsCjeeItUuvgOWf1v4qoK9RF6k=\");\nvar _c;\n$RefreshReg$(_c, \"AuthProvider\");","map":{"version":3,"names":["React","createContext","useContext","useEffect","useState","jsxDEV","_jsxDEV","USERS_KEY","CURRENT_KEY","defaultUsers","admin","password","role","readUsers","raw","localStorage","getItem","JSON","parse","writeUsers","users","setItem","stringify","AuthContext","AuthProvider","children","_s","setUsers","currentUser","setCurrentUser","removeItem","login","username","u","Error","logout","addUser","next","changePassword","oldPass","newPass","target","value","Provider","fileName","_jsxFileName","lineNumber","columnNumber","_c","useAuth","_s2","$RefreshReg$"],"sources":["/Users/isakhan/Documents/MapboxProject/frontend/src/auth/AuthContext.js"],"sourcesContent":["import React, { createContext, useContext, useEffect, useState } from 'react';\n\nconst USERS_KEY = 'app_users_v1';\nconst CURRENT_KEY = 'app_current_user_v1';\n\n// Seed a default admin on first load\nconst defaultUsers = {\n  admin: { password: 'admin', role: 'admin' },\n};\n\nfunction readUsers() {\n  try {\n    const raw = localStorage.getItem(USERS_KEY);\n    return raw ? JSON.parse(raw) : defaultUsers;\n  } catch {\n    return defaultUsers;\n  }\n}\nfunction writeUsers(users) {\n  localStorage.setItem(USERS_KEY, JSON.stringify(users));\n}\n\nconst AuthContext = createContext(null);\n\nexport function AuthProvider({ children }) {\n  const [users, setUsers] = useState(() => readUsers());\n  const [currentUser, setCurrentUser] = useState(() => {\n    try {\n      const raw = localStorage.getItem(CURRENT_KEY);\n      return raw ? JSON.parse(raw) : null;\n    } catch {\n      return null;\n    }\n  });\n\n  useEffect(() => writeUsers(users), [users]);\n\n  useEffect(() => {\n    if (currentUser)\n      localStorage.setItem(CURRENT_KEY, JSON.stringify(currentUser));\n    else localStorage.removeItem(CURRENT_KEY);\n  }, [currentUser]);\n\n  const login = (username, password) => {\n    const u = users[username];\n    if (!u || u.password !== password) throw new Error('Invalid credentials');\n    setCurrentUser({ username, role: u.role });\n  };\n\n  const logout = () => setCurrentUser(null);\n\n  const addUser = (username, password, role = 'user') => {\n    if (!currentUser || currentUser.role !== 'admin')\n      throw new Error('Only admin can add users');\n    if (!username || !password)\n      throw new Error('Username and password required');\n    if (users[username]) throw new Error('User already exists');\n    const next = { ...users, [username]: { password, role } };\n    setUsers(next);\n  };\n\n  // Users can change their own password; admin can change theirs too.\n  const changePassword = (username, oldPass, newPass) => {\n    const target = users[username];\n    if (!target) throw new Error('User not found');\n    if (currentUser.username !== username && currentUser.role !== 'admin')\n      throw new Error('Not allowed');\n\n    // If changing your own password, verify old password\n    if (currentUser.username === username && target.password !== oldPass)\n      throw new Error('Old password incorrect');\n\n    const next = { ...users, [username]: { ...target, password: newPass } };\n    setUsers(next);\n    if (currentUser.username === username)\n      setCurrentUser({ username, role: target.role }); // keep session\n  };\n\n  const value = { users, currentUser, login, logout, addUser, changePassword };\n  return <AuthContext.Provider value={value}>{children}</AuthContext.Provider>;\n}\n\nexport const useAuth = () => useContext(AuthContext);\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}